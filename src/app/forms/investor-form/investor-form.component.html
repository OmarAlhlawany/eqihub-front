
<div class="investor-form-container" id="FormContainer">
      <h2 class="form-title">{{ 'INVESTOR_FORM.TITLE' | translate }}</h2>
  <form [formGroup]="investorForm" (ngSubmit)="onSubmit()" class="form-container">
    <p class="form-description">{{ 'INVESTOR_FORM.DESCRIPTION' | translate }}</p>
    <hr>
    <!-- Step Indicator (Hidden on Step 5) -->
    <div *ngIf="currentStep !== 5" class="form-steps-indicator d-flex align-items-center mb-4">
      <div class="step-indicator">
        <span class="step-circle no-tra" [ngClass]="{'active': currentStep >= 1, 'unlocked': currentStep > 1}">1</span>
        <div class="step-line step-1" [ngClass]="{'half-filled': currentStep === 1, 'fully-filled': currentStep > 1}"></div>
      </div>
      <div class="step-indicator">
        <span class="step-circle" [ngClass]="{'active': currentStep >= 2, 'unlocked': currentStep > 2}">2</span>
        <div class="step-line step-2" [ngClass]="{'half-filled': currentStep === 2, 'fully-filled': currentStep > 2}"></div>
      </div>
      <div class="step-indicator">
        <span class="step-circle" [ngClass]="{'active': currentStep >= 3, 'unlocked': currentStep > 3}">3</span>
        <div class="step-line step-3" [ngClass]="{'half-filled': currentStep === 3, 'fully-filled': currentStep > 3}"></div>
      </div>
      <div class="step-indicator">
        <span class="step-circle" [ngClass]="{'active': currentStep >= 4, 'unlocked': currentStep > 4}">4</span>
      </div>
      <!-- Step 5 Indicator (Only shown on Step 5) -->
      <div class="step-indicator" *ngIf="currentStep === 5">
        <span class="step-circle" [ngClass]="{'active': currentStep >= 5, 'unlocked': currentStep === 5}">5</span>
      </div>
    </div>
    <!-- Line under the step indicators -->
    <div *ngIf="currentStep !== 5" class="step-indicator-line"></div>

    <!-- Step 1: Contact Details -->
    <div *ngIf="currentStep === 1" class="form-step step-1">
      <h3>{{ 'INVESTOR_FORM.STEP_1.TITLE' | translate }}</h3>
      <!-- <p>{{ 'INVESTOR_FORM.STEP_1.DESCRIPTION' | translate }}</p> -->

      <div class="row mb-3">
        <div class="col-md-6">
          <label for="name">{{ 'INVESTOR_FORM.STEP_1.NAME' | translate }}<span class="required-asterisk">*</span></label>
          <div class="input-icon-container">
            <img src="assets/person.svg" alt="person" class="material-icons" />
            <input id="name" formControlName="name" placeholder="{{ 'INVESTOR_FORM.STEP_1.NAME_PLACEHOLDER' | translate }}" class="form-control" required />
          </div>
          <div *ngIf="investorForm.get('name')?.invalid && (investorForm.get('name')?.dirty || investorForm.get('name')?.touched)" class="text-danger">
            <div *ngIf="investorForm.get('name')?.errors?.['required']">{{ 'INVESTOR_FORM.STEP_1.NAME_REQUIRED' | translate }}</div>
            <div *ngIf="investorForm.get('name')?.errors?.['minlength']">{{ 'INVESTOR_FORM.STEP_1.NAME_MIN_LENGTH' | translate }}</div>
          </div>
        </div>

        <div class="col-md-6">
          <label for="email">{{ 'INVESTOR_FORM.STEP_1.EMAIL' | translate }}<span class="required-asterisk">*</span></label>
          <div class="input-icon-container">
            <i class="material-icons">email</i>
            <input id="email" type="email" formControlName="email" placeholder="{{ 'INVESTOR_FORM.STEP_1.EMAIL_PLACEHOLDER' | translate }}" class="form-control" required />
          </div>
          <div *ngIf="investorForm.get('email')?.invalid && (investorForm.get('email')?.dirty || investorForm.get('email')?.touched)" class="text-danger">
            <div *ngIf="investorForm.get('email')?.errors?.['required']">{{ 'INVESTOR_FORM.STEP_1.EMAIL_REQUIRED' | translate }}</div>
            <div *ngIf="investorForm.get('email')?.errors?.['email']">{{ 'INVESTOR_FORM.STEP_1.EMAIL_INVALID' | translate }}</div>
          </div>
        </div>
      </div>

      <div class="row mb-3">
        <div class="col-md-6">
          <label for="phone_number">{{ 'INVESTOR_FORM.STEP_1.PHONENUMBER' | translate }}<span class="required-asterisk">*</span></label>
          <div class="input-icon-container">
            <i class="material-icons">call</i>
            <input id="phoneNumber" type="tel" formControlName="phone_number" placeholder="{{ 'INVESTOR_FORM.STEP_1.PHONENUMBER_PLACEHOLDER' | translate }}" class="form-control" required />
          </div>
          <div *ngIf="investorForm.get('phone_number')?.invalid && (investorForm.get('phone_number')?.dirty || investorForm.get('phone_number')?.touched)" class="text-danger">
            <div *ngIf="investorForm.get('phone_number')?.errors?.['required']">{{ 'INVESTOR_FORM.STEP_1.PHONENUMBER_REQUIRED' | translate }}</div>
            <div *ngIf="investorForm.get('phone_number')?.errors?.['pattern']">{{ 'INVESTOR_FORM.STEP_1.PHONENUMBER_INVALID' | translate }}</div>
          </div>
        </div>

        <div class="col-md-6">
          <label for="company">{{ 'INVESTOR_FORM.STEP_1.COMPANY' | translate }}<span class="required-asterisk">*</span></label>
          <div class="input-icon-container">
            <i class="material-icons">work</i>
            <input id="company" formControlName="company" placeholder="{{ 'INVESTOR_FORM.STEP_1.COMPANY_PLACEHOLDER' | translate }}" class="form-control" required />
          </div>
          <div *ngIf="investorForm.get('company')?.invalid && (investorForm.get('company')?.dirty || investorForm.get('company')?.touched)" class="text-danger">
            <div *ngIf="investorForm.get('company')?.errors?.['required']">{{ 'INVESTOR_FORM.STEP_1.COMPANY_REQUIRED' | translate }}</div>
            <div *ngIf="investorForm.get('company')?.errors?.['minlength']">{{ 'INVESTOR_FORM.STEP_1.COMPANY_MIN_LENGTH' | translate }}</div>
          </div>
        </div>
      </div>
    </div>

    <!-- Step 2: Investment Details -->
    <div *ngIf="currentStep === 2" class="form-step step-2">
      <div class="form-group">
        <label for="investment_type_id">{{ 'INVESTOR_FORM.STEP_2.INVESTMENT' | translate }}<span class="required-asterisk">*</span></label>
        <select id="investment_type_id" formControlName="investment_type_id" required>
          <option value="" disabled selected>{{ 'INVESTOR_FORM.STEP_2.SELECT_INVESTMENT' | translate }}</option>
          <option *ngFor="let type of dynamicData.investment_types" [value]="type.id">{{ type.name }}</option>
        </select>
        <div *ngIf="investorForm.get('investment_type_id')?.invalid && (investorForm.get('investment_type_id')?.dirty || investorForm.get('investment_type_id')?.touched)" class="text-danger">
          <div *ngIf="investorForm.get('investment_type_id')?.errors?.['required']">{{ 'INVESTOR_FORM.STEP_2.INVESTMENT_REQUIRED' | translate }}</div>
        </div>
      </div>

      <div class="form-group">
        <label for="favourite_investment_stage_id">{{ 'INVESTOR_FORM.STEP_2.FAVORITE_INVESTMENT' | translate }}<span class="required-asterisk">*</span></label>
        <select id="favourite_investment_stage_id" formControlName="favourite_investment_stage_id" required>
          <option value="" disabled selected>{{ 'INVESTOR_FORM.STEP_2.SELECT_FAVORITE_INVESTMENT' | translate }}</option>
          <option *ngFor="let stage of dynamicData.favourite_investment_stages" [value]="stage.id">{{ stage.name }}</option>
        </select>
        <div *ngIf="investorForm.get('favourite_investment_stage_id')?.invalid && (investorForm.get('favourite_investment_stage_id')?.dirty || investorForm.get('favourite_investment_stage_id')?.touched)" class="text-danger">
          <div *ngIf="investorForm.get('favourite_investment_stage_id')?.errors?.['required']">{{ 'INVESTOR_FORM.STEP_2.FAVORITE_INVESTMENT_REQUIRED' | translate }}</div>
        </div>
      </div>

      <!-- Favourite Sectors Dropdown -->
      <div class="form-group">
        <label for="favourite_sectors">{{ 'INVESTOR_FORM.STEP_2.FAVORITE_SECTORS' | translate }}<span class="required-asterisk">*</span></label>
        <div class="dropdown" style="position: relative;">
          <button type="button" class="dropdown-toggle" (click)="toggleDropdown()">
            {{ 'INVESTOR_FORM.STEP_2.SELECT_FAVORITE_SECTORS' | translate }}
          </button>
          <div class="dropdown-menu show" *ngIf="showDropdown">
            <span *ngFor="let sector of dynamicData.favourite_sectors" class="dropdown-item" (click)="toggleTag(sector)">
              {{ sector.name }}
            </span>
          </div>
        </div>
        <div class="tags-input" id="favoriteSectors">
          <span class="tag selected" *ngFor="let tagValue of selectedTags">
            {{ getTagLabel(tagValue) | translate }}
            <span class="tag-close" (click)="removeTag(tagValue)">Ã—</span>
          </span>
        </div>
        <div *ngIf="investorForm.get('favourite_sectors')?.invalid && (investorForm.get('favourite_sectors')?.dirty || investorForm.get('favourite_sectors')?.touched)" class="text-danger">
          <div *ngIf="investorForm.get('favourite_sectors')?.errors?.['required']">{{ 'INVESTOR_FORM.STEP_2.FAVORITE_SECTORS_REQUIRED' | translate }}</div>
        </div>
      </div>
    </div>

    <!-- Step 3: Project Budget -->
    <div *ngIf="currentStep === 3" class="form-step step-3">
      <h3>{{ 'INVESTOR_FORM.STEP_3.PROJECT_BUDGET' | translate }} <span class="required-asterisk">*</span></h3>
      <div class="budget-options">
        <div *ngFor="let range of dynamicData.budget_ranges" class="custom-control custom-radio budget-option">
          <input
            type="radio"
            formControlName="budget_range_id"
            [value]="range.id"
            class="custom-control-input"
            [id]="'budget' + range.id"
            required
          />
          <label class="custom-control-label" [for]="'budget' + range.id">{{ range.name }}</label>
        </div>
      </div>
      <div *ngIf="investorForm.get('budget_range_id')?.invalid && (investorForm.get('budget_range_id')?.dirty || investorForm.get('budget_range_id')?.touched)" class="text-danger">
        <div *ngIf="investorForm.get('budget_range_id')?.errors?.['required']">{{ 'INVESTOR_FORM.STEP_3.PROJECT_BUDGET_REQUIRED' | translate }}</div>
      </div>
    </div>

    <!-- Step 4: Additional Information -->
    <div *ngIf="currentStep === 4" class="form-step step-4">
      <div class="form-group">
        <label for="geographical_scope_id">{{ 'INVESTOR_FORM.STEP_4.GEOGRAPHICAL_SCOPE' | translate }}<span class="required-asterisk">*</span></label>
        <select id="geographical_scope_id" formControlName="geographical_scope_id" required>
          <option value="" disabled selected>{{ 'INVESTOR_FORM.STEP_4.SELECT_GEOGRAPHICAL_SCOPE' | translate }}</option>
          <option *ngFor="let scope of dynamicData.geographical_scopes" [value]="scope.id">{{ scope.name }}</option>
        </select>
        <div *ngIf="investorForm.get('geographical_scope_id')?.invalid && (investorForm.get('geographical_scope_id')?.dirty || investorForm.get('geographical_scope_id')?.touched)" class="text-danger">
          <div *ngIf="investorForm.get('geographical_scope_id')?.errors?.['required']">{{ 'INVESTOR_FORM.STEP_4.GEOGRAPHICAL_SCOPE_REQUIRED' | translate }}</div>
        </div>
      </div>

      <div class="form-group">
        <label for="co_invest_id">{{ 'INVESTOR_FORM.STEP_4.CO_INVEST' | translate }}<span class="required-asterisk">*</span></label>
        <select id="co_invest_id" formControlName="co_invest_id" required>
          <option value="" disabled selected>{{ 'INVESTOR_FORM.STEP_4.SELECT_CO_INVEST' | translate }}</option>
          <option *ngFor="let option of dynamicData.yes_no_options" [value]="option.id">{{ option.name }}</option>
        </select>
        <div *ngIf="investorForm.get('co_invest_id')?.invalid && (investorForm.get('co_invest_id')?.dirty || investorForm.get('co_invest_id')?.touched)" class="text-danger">
          <div *ngIf="investorForm.get('co_invest_id')?.errors?.['required']">{{ 'INVESTOR_FORM.STEP_4.CO_INVEST_REQUIRED' | translate }}</div>
        </div>
      </div>

      <div class="form-group">
        <label for="investment_privacy_option_id">{{ 'INVESTOR_FORM.STEP_4.INVESTMENT_PRIVACY' | translate }}<span class="required-asterisk">*</span></label>
        <select id="investment_privacy_option_id" formControlName="investment_privacy_option_id" required>
          <option value="" disabled selected>{{ 'INVESTOR_FORM.STEP_4.SELECT_INVESTMENT_PRIVACY' | translate }}</option>
          <option *ngFor="let option of dynamicData.investment_privacy_options" [value]="option.id">{{ option.name }}</option>
        </select>
        <div *ngIf="investorForm.get('investment_privacy_option_id')?.invalid && (investorForm.get('investment_privacy_option_id')?.dirty || investorForm.get('investment_privacy_option_id')?.touched)" class="text-danger">
          <div *ngIf="investorForm.get('investment_privacy_option_id')?.errors?.['required']">{{ 'INVESTOR_FORM.STEP_4.INVESTMENT_PRIVACY_REQUIRED' | translate }}</div>
        </div>
      </div>

      <div class="form-group custom-textarea-wrapper">
        <label for="additional_notes">{{ 'INVESTOR_FORM.STEP_4.ADDITIONAL_NOTES' | translate }}</label>
        <textarea id="additional_notes" formControlName="additional_notes" placeholder="{{ 'INVESTOR_FORM.STEP_4.ADDITIONAL_NOTES_PLACEHOLDER' | translate }}" class="form-control custom-textarea"></textarea>
        <div class="resize-icon"></div>
      </div>
    </div>

    <!-- Step 5: Submit Step -->
    <div *ngIf="currentStep === 5" class="form-step step-5">
      <div class="submit-box">
        <img src="../../assets/Logo.svg" alt="Submit Icon" class="submit-icon" />
        <h4 class="submit-title">{{ 'INVESTOR_FORM.STEP_5.SUBMIT_TITLE' | translate }}</h4>
        <p class="submit-description">
          {{ 'INVESTOR_FORM.STEP_5.SUBMIT_DESCRIPTION' | translate }}
        </p>
        <div class="submitted-text">{{ 'INVESTOR_FORM.STEP_5.SUBMITTED_TEXT' | translate }}</div>
      </div>
    </div>
    
  <!-- Navigation Buttons -->
  <div class="form-navigation" [ngClass]="{'multiple-buttons': currentStep !== 1}">
    <!-- Previous Button -->
    <button type="button" (click)="prevStep()" class="btn btn-secondary" *ngIf="currentStep !== 0">
      {{ currentStep === 1 ? ('INVESTOR_FORM.NAVIGATION.CANCEL' | translate) : ('INVESTOR_FORM.NAVIGATION.PREVIOUS_STEP' | translate) }}
    </button>
    

    <!-- Next or Submit Button -->
    <ng-container *ngIf="currentStep !== 4 && currentStep !== 5">
      <button type="button" (click)="nextStep()" class="btn btn-primary">
        {{ 'INVESTOR_FORM.NAVIGATION.NEXT_STEP' | translate }}
      </button>
    </ng-container>

    <!-- Submit Button for Step 4 -->
    <ng-container *ngIf="currentStep === 4">
      <button type="submit" [disabled]="!isStepValid(4)" class="btn btn-success" (click)="nextStep()" (click)="onSubmit()">
        {{ 'INVESTOR_FORM.STEP_5.SUBMIT_BUTTON' | translate }}
      </button>
    </ng-container>
  </div>
  </form>
</div>